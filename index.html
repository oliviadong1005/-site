<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <!-- è®©æ‰‹æœºæµè§ˆå™¨æŒ‰çœŸå®åƒç´ æ¸²æŸ“ï¼Œå…è®¸æ¨ªç«–å±åˆ‡æ¢ -->
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes" />
  <title>å¼ æ²›æ— â€” ä¸»é¡µ</title>

  <!-- ç»Ÿä¸€æš—è‰²æç®€é£æ ¼ + å“åº”å¼ -->
  <style>
    /* å…¨å±€æ ·å¼ */
    html,body{
      margin:0;
      padding:0;
      font-family:"Noto Sans SC","Microsoft YaHei",sans-serif;
      background:#0f1724;
      color:#e6f0f2;
      min-height:100vh;
    }

    /* å±…ä¸­å®¹å™¨ï¼Œç§»åŠ¨ç«¯ä¹Ÿå‹å¥½ */
    .wrapper{
      max-width:680px;
      margin:0 auto;
      padding:2rem 1rem;
      box-sizing:border-box;
    }

    h1{margin:.2em 0 .6em;font-size:1.8rem;}

    /* å¤´åƒ */
    .avatar{
      max-width:180px;
      border-radius:12px;
      margin:16px 0;
    }

    /* æŒ‰é’®é“¾æ¥ */
    .btn{
      display:block;
      padding:14px 20px;
      background:#1e293b;
      color:#6ee7b7;
      text-decoration:none;
      border-radius:8px;
      margin:10px 0;
      font-size:1rem;
      text-align:center;
      transition:.2s;
    }
    .btn:hover{background:#334155;}

    /* Cbox åŒºåŸŸ */
    #cbox-wrapper{
      width:100%;
      margin-top:2rem;
    }
    #cbox-iframe{
      width:100%;
      height:60vh;          /* æ‰‹æœºç«–å±å  60% è§†å£é«˜åº¦ */
      border:1px solid #334155;
      border-radius:8px;
      background:#fff;      /* Cbox æœ¬èº«ç™½åº•ï¼Œé¿å…é»‘æ¡† */
    }

    /* ç”µè„‘ç«¯åŠ å¤§é«˜åº¦ */
    @media (min-width:768px){
      #cbox-iframe{height:480px;}
    }
  </style>
</head>

<body>
  <div class="wrapper">
    <h1>å¼ æ²›æ— â€” ä¸»é¡µ</h1>

    <img class="avatar" src="avatar.jpg" alt="å¼ æ²›æ—å¤´åƒ">

    <p>å¼ æ²›æ—æ˜¯ä¸€æ¬¾äººå·¥æ™ºèƒ½åŠ©æ‰‹ã€‚</p>

    <a class="btn" href="zhangpeilin.html">å¼ æ²›æ—</a>
    <a class="btn" href="huoqu.html">å¦‚ä½•è·å–è½¯ä»¶</a>
    <a class="btn" href="match3.html">å¼ æ²›æ—æ¶ˆæ¶ˆä¹</a>


    <!-- ===== Cbox èŠå¤©å®¤ ===== -->
<!-- è§¦å‘æŒ‰é’® -->
<button id="toggleChat" class="btn">æ‰“å¼€èŠå¤©å®¤</button>

<!-- èŠå¤©å®¤å®¹å™¨ï¼Œåˆå§‹éšè— -->
<div id="cbox-wrapper" style="display:none">
  <iframe id="cbox-iframe"
          src="about:blank"
          data-src="https://www3.cbox.ws/box/?boxid=3548406&boxtag=YWZJ56"
          width="100%"
          height="480"
          frameborder="0"
          scrolling="auto">
  </iframe>
</div>

<script>
  (function () {
    const btn   = document.getElementById('toggleChat');
    const wrap  = document.getElementById('cbox-wrapper');
    const ifr   = document.getElementById('cbox-iframe');

    btn.addEventListener('click', function () {
      const isHidden = wrap.style.display === 'none';
      if (isHidden) {                 // â†’ å±•å¼€
        if (ifr.src === 'about:blank') {
          ifr.src = ifr.dataset.src;  // é¦–æ¬¡åŠ è½½
        }
        wrap.style.display = 'block';
        btn.textContent = 'æ”¶èµ·èŠå¤©å®¤';
      } else {                        // â†’ æŠ˜å 
        wrap.style.display = 'none';
        btn.textContent = 'æ‰“å¼€èŠå¤©å®¤';
      }
    });
  })();
</script>
<!-- èŠå¤©æ¡† -->
<!-- zpl èŠå¤©åŒº -->
<div id="chat" style="margin-top:40px;max-width:600px;">
  <div id="messages" style="border:1px solid #ccc;height:200px;overflow-y:auto;padding:6px;"></div>
  <input id="input" placeholder="å’Œå¼ æ²›æ—èŠèŠâ€¦" style="width:70%;padding:4px;">
  <button id="sendBtn" style="width:25%;">å‘é€</button>
</div>

<script>
const API_KEY = 'sk-9OTVzZThhOSJdwmtA5nogwI7PFQlUgxuPAGDnM1rGixmdEvm';

const messagesEl = document.getElementById('messages');
const inputEl    = document.getElementById('input');
const sendBtn    = document.getElementById('sendBtn');

const addMsg = (who, text) => {
  const div = document.createElement('div');
  div.textContent = `${who}: ${text}`;
  messagesEl.appendChild(div);
  messagesEl.scrollTop = messagesEl.scrollHeight;
};

sendBtn.onclick = async () => {
  const text = inputEl.value.trim();
  if (!text) return;
  addMsg('ä½ ', text);
  inputEl.value = '';

  const res = await fetch('https://api.moonshot.cn/v1/chat/completions', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      Authorization: `Bearer ${API_KEY}`
    },
    body: JSON.stringify({
      model: 'moonshot-v1-8k',
      messages: [
        { role: 'system', content: 'ä½ æ˜¯å¼ æ²›æ—ï¼Œå›ç­”è¾ƒä¸ºæ¸©æŸ”ï¼Œä¸çŸ¥é“å‘ä»€ä¹ˆçš„æ—¶å€™å°±å›ä¸€ä¸ªqiepæˆ–è€…Emojiï¼Œå›ç­”ç®€æ´ã€‚' },
        { role: 'user',   content: text }
      ]
    })
  });
  const data = await res.json();
  const reply = data.choices?.[0]?.message?.content || 'å‡ºé”™äº† ğŸ˜…';
  addMsg('zpl', reply);
};
</script>

</body>
</html>
